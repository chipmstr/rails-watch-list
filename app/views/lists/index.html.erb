<div class="container mt-4"> <!-- added container for consistent width -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">My Lists</h1> <!-- title for the lists page -->
    <div>
      <%= link_to '<i class="fas fa-plus"></i> Create a new list'.html_safe, new_list_path, class: 'btn btn-success me-2' %> <!-- button to create a new list with plus icon -->
      <%= link_to 'View Movies', movies_path, class: 'btn btn-secondary' %> <!-- button to navigate to movies page -->
    </div>
  </div>

  <div class="row">
    <% @lists.each do |list| %> <!-- iterate through each list -->
      <div class="col-md-3">
        <div class="card mb-4 d-flex flex-column" style="height: 600px;"> <!-- Fixed height for the card -->

          <!-- Image Section: Let the image cover the full width and fixed height, rectangular shape -->
          <% if list.photo.attached? %>
            <%= cl_image_tag list.photo.key, class: "card-img-top", style: "height: 400px; object-fit: cover; width: 100%;" %> <!-- Adjusted to rectangular portrait orientation -->
          <% else %>
            <%= image_tag "https://via.placeholder.com/350x500", class: "card-img-top", style: "height: 400px; object-fit: cover; width: 100%;" %> <!-- Placeholder with rectangular shape -->
          <% end %>

          <!-- Card Body: Display the list name and reviews -->
          <div class="card-body d-flex flex-column justify-content-between" style="flex-grow: 1; padding-bottom: 10px;"> <!-- Fixed padding to control layout -->

            <!-- List Name -->
            <h5 class="card-title text-center" style="font-weight: bold; margin-bottom: 20px; text-transform: uppercase;"><%= list.name %></h5>

            <!-- Reviews or No Reviews Section -->
            <div class="mt-auto"> <!-- Add mt-auto to push content to bottom -->
              <!-- Reviews or No Reviews Section -->
              <% if list.bookmarks.any? %>
                <div class="rating-stars" style="text-align: left; padding-left: 5px; margin-bottom: 5px;"> <!-- Add margin-bottom to create space between ratings and the button -->
                  <% average_rating = list.bookmarks.joins(movie: :reviews).average('reviews.rating').to_f %>
                  <% if average_rating > 0 %>
                    <span class="average-rating-text">Average Rating:</span>
                    <div>
                      <% (1..5).each do |i| %>
                        <% star_class = (i <= average_rating) ? 'fas fa-star' : (i == average_rating + 0.5 ? 'fas fa-star-half-alt' : 'far fa-star') %>
                        <i class="<%= star_class %>" style="color: gold; font-size: 1.2rem; margin-right: 3px;"></i>
                      <% end %>
                    </div>
                  <% else %>
                    <p style="font-size: 1rem; color: gray;">No ratings yet</p>
                  <% end %>
                </div>
              <% else %>
                <p style="font-size: 1rem; color: gray; padding-left: 10px; text-align: center;">No movies in this list!</p> <!-- Placeholder for no movies -->
              <% end %>
            </div>
          </div>

          <!-- View Button -->
          <div class="card-footer" style="padding: 10px; background-color: transparent; border-top: none; margin-top: auto;"> <!-- Keep the button at the bottom -->
            <%= link_to "View", list_path(list), class: "btn btn-primary w-100" %>
          </div>

        </div>
      </div>
    <% end %>
  </div>
</div>
